<app-spinner [spinnerSize]="'medium'" [fullScreen]="true"></app-spinner>
<div class="row header-container">
    <div class="col">
        <h3>Sensor Name : {{mapSensorDetailsData.name}}</h3>
        <div class="device-status-property" *ngIf="isOnline">
            <span class="connection-status connected text-success">Online</span>
        </div>
        <div class="device-status-property" *ngIf="!isOnline">
            <span class="connection-status disconnected text-danger">Offline</span>
        </div>
    </div>
    <div class="col">
        <button class="btn btn-m btn-primary float-right" routerLink="../.."> 
            <span class="d-none d-md-inline-block">Back</span> 
        </button>
    </div>
</div>

<hr>

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-horizontal-custom">

        <div class="jumbotron jumbotron-fluid">

            <div class="row">
                <div class="jumbotron-header col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <app-filter-bar
                        (dateTimeChangeEvent)="onDateTimeChange($event)"
                        [ngSelectItemsforComparision]="ddSensorsList"
                        [ngSelectItemsforYaxis]="yaxisList"
                        (ngSelectChangeEvent)="onItemChanged($event)"
                        (ngSelectAddEvent)="onItemAdded($event)"
                        (ngSelectRemoveEvent)="onItemRemoved($event)"
                        (ngSelectClearEvent)="onClear()"
                    >
                    </app-filter-bar>
                </div>
            </div>

            <div class="row">

                <div class="col-lg-8 col-md-12 col-sm-12 col-xs-12">
                    <div id="highChart" ></div>
                </div>

                <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 form-horizontal-custom">

                    <form class="form-horizontal" role="form" name="sensorDetailsForm" [formGroup]="sensorDetailsForm">

                        <div class="form-group row mt">

                            <label for="sensorID"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Sensor ID:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="sensorID" class="form-control-plaintext pl-3" formControlName="sensorID" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="readingValue"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Current Reading:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="readingValue" class="form-control-plaintext pl-3" formControlName="readingValue" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt" *ngIf="sensorDetailsForm.get('humidity').value">

                            <label for="humidity"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Humidity:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="humidity" class="form-control-plaintext pl-3" formControlName="humidity" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="lastCommDate"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Last Communication Date:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="lastCommDate" class="form-control-plaintext pl-3" formControlName="lastCommDate" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="gatewayName"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Gateway Name:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <textarea rows="1" class="form-control-plaintext pl-3" id="gatewayName" formControlName="gatewayName" readonly></textarea>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="minThres"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Minimum Threshold:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="minThres" class="form-control-plaintext pl-3" formControlName="minThres" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="maxThres"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Maximum Threshold:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                              <input type="text" id="maxThres" class="form-control-plaintext pl-3" formControlName="maxThres" readonly/>
                            </div>
                    
                        </div>

                        <div class="form-group row mt">

                            <label for="transmitterType"  class="col-form-label col-lg-5 col-md-5 col-sm-12 col-xs-12">Sensor Type:</label>
                    
                            <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
                                <textarea rows="2" class="form-control-plaintext pl-3" id="transmitterType" formControlName="transmitterType" readonly></textarea>
                            </div>
                    
                        </div>

                    </form>

                </div>

            </div>
            
        </div>
    </div>
</div>

<div class="row">

    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

        <section 
            class="mx-auto"
            widgster
            [optionsControl]="false"
            [reloadControl]="false"
            [fullscreenControl]="false"
            [collapseControl]="false"
            [closeControl]="false"
            titleClass="mt-0"
            bodyclass="widget-table-overflow">
                <header>
                    <h5 class="title float-left">Sensor Data</h5>
                    <angular2csv [data]="downloadCSVdata" filename={{CSVfilename}} [options]="downloadCSVoptions" class="downloadCSV float-right"></angular2csv>
                </header>
                <div class="widget-content">
                    <ngx-datatable class="table table-striped table-hover" [rows]="sensorDataTable"
                    [columnMode]="columnMode.force" [headerHeight]="50" [footerHeight]="50" 
                    [rowHeight]="'auto'" [limit]="10" [sorts]="[{prop: 'timestamp', dir: 'desc'}]">
                        <ngx-datatable-column name="Timestamp" prop="timestamp">
                            <ng-template let-column="column" ngx-datatable-header-template>
                                <span>{{column.name}}</span>
                            </ng-template>
                            <ng-template let-value="value" ngx-datatable-cell-template let-row="row">
                            {{value}}
                            </ng-template>
                        </ngx-datatable-column>
                
                        <ngx-datatable-column name="Temperature (Â°C)" prop="temperature">
                            <ng-template let-column="column" ngx-datatable-header-template>
                                <span>{{column.name}}</span>
                            </ng-template>
                            <ng-template let-value="value" ngx-datatable-cell-template let-row="row">
                            {{value}}
                            </ng-template>
                        </ngx-datatable-column>
                    </ngx-datatable>
                </div>
        </section>

    </div>

</div>

<ng-template #datepickermodalTemplate>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Datepicker</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <app-ngx-bootstrap-datepicker (onDateTimeChange)="onDateTimeChange($event)"></app-ngx-bootstrap-datepicker>
    </div>
</ng-template>